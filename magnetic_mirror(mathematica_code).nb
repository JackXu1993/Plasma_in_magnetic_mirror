(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     25463,        766]
NotebookOptionsPosition[     25122,        750]
NotebookOutlinePosition[     25476,        766]
CellTagsIndexPosition[     25433,        763]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}],
   FontSize->14], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bx0", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
    RowBox[{
     FractionBox[
      RowBox[{" ", 
       RowBox[{"R", " ", "z", " ", 
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"], "+", 
         SuperscriptBox["R", "2"], "-", 
         RowBox[{"2", "x", " ", "R", " ", 
          RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "-", 
         RowBox[{"2", "y", " ", "R", " ", 
          RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[CurlyPhi]", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"MaxRecursion", "\[Rule]", "12"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"By0", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
    RowBox[{
     FractionBox[
      RowBox[{" ", 
       RowBox[{"R", " ", "z", " ", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"], "+", 
         SuperscriptBox["R", "2"], "-", 
         RowBox[{"2", "x", " ", "R", " ", 
          RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "-", 
         RowBox[{"2", "y", " ", "R", " ", 
          RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[CurlyPhi]", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"MaxRecursion", "\[Rule]", "12"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bz0", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
    RowBox[{
     FractionBox[
      RowBox[{" ", 
       RowBox[{"R", " ", 
        RowBox[{"(", 
         RowBox[{"R", "-", 
          RowBox[{"x", " ", 
           RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "-", 
          RowBox[{"y", " ", 
           RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], ")"}]}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"], "+", 
         SuperscriptBox["R", "2"], "-", 
         RowBox[{"2", "x", " ", "R", " ", 
          RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "-", 
         RowBox[{"2", "y", " ", "R", " ", 
          RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[CurlyPhi]", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"MaxRecursion", "\[Rule]", "12"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bx", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Bx0", "[", 
     RowBox[{"x", ",", "y", ",", 
      RowBox[{"z", "-", 
       RowBox[{"d", "/", "2"}]}]}], "]"}], "+", 
    RowBox[{"Bx0", "[", 
     RowBox[{"x", ",", "y", ",", 
      RowBox[{"z", "+", 
       RowBox[{"d", "/", "2"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"By", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"By0", "[", 
     RowBox[{"x", ",", "y", ",", 
      RowBox[{"z", "-", 
       RowBox[{"d", "/", "2"}]}]}], "]"}], "+", 
    RowBox[{"By0", "[", 
     RowBox[{"x", ",", "y", ",", 
      RowBox[{"z", "+", 
       RowBox[{"d", "/", "2"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bz", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Bz0", "[", 
     RowBox[{"x", ",", "y", ",", 
      RowBox[{"z", "-", 
       RowBox[{"d", "/", "2"}]}]}], "]"}], "+", 
    RowBox[{"Bz0", "[", 
     RowBox[{"x", ",", "y", ",", 
      RowBox[{"z", "+", 
       RowBox[{"d", "/", "2"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", "1.0"}], ";", 
  RowBox[{"d", "=", 
   RowBox[{"2", " ", "R"}]}], ";", 
  RowBox[{"n", "=", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data1", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"data1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"3", "R"}], "n"], " ", "i"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"3", "R"}], "n"], " ", "j"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"2", "d"}], "n"], " ", "k"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Bx", "[", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"3", "R"}], "n"], " ", "i"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"3", "R"}], "n"], " ", "j"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"2", "d"}], "n"], " ", "k"}]}], "]"}]}], "}"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"-", "n"}], "/", "2"}], ",", 
         RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{
        RowBox[{"-", "n"}], "/", "2"}], ",", 
       RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"{", 
    RowBox[{"k", ",", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}], ",", 
     RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bx", "=", 
   RowBox[{"Interpolation", "[", "data1", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bx", ">>", "\"\<Bx50\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data2", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"data2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"3", "R"}], "n"], " ", "i"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"3", "R"}], "n"], " ", "j"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"2", "d"}], "n"], " ", "k"}], ",", "\[IndentingNewLine]", 
           RowBox[{"By", "[", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"3", "R"}], "n"], " ", "i"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"3", "R"}], "n"], " ", "j"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"2", "d"}], "n"], " ", "k"}]}], "]"}]}], "}"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"-", "n"}], "/", "2"}], ",", 
         RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{
        RowBox[{"-", "n"}], "/", "2"}], ",", 
       RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"{", 
    RowBox[{"k", ",", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}], ",", 
     RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"By", "=", 
   RowBox[{"Interpolation", "[", "data2", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"By", ">>", "\"\<By50\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data3", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"data3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"3", "R"}], "n"], " ", "i"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"3", "R"}], "n"], " ", "j"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"2", "d"}], "n"], " ", "k"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Bz", "[", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"3", "R"}], "n"], " ", "i"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"3", "R"}], "n"], " ", "j"}], ",", 
             RowBox[{
              FractionBox[
               RowBox[{"2", "d"}], "n"], " ", "k"}]}], "]"}]}], "}"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"-", "n"}], "/", "2"}], ",", 
         RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{
        RowBox[{"-", "n"}], "/", "2"}], ",", 
       RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"{", 
    RowBox[{"k", ",", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}], ",", 
     RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bz", "=", 
   RowBox[{"Interpolation", "[", "data3", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bz", ">>", "\"\<Bz50\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.666962206490622*^9, 3.666962207128778*^9}, 
   3.6669622562393703`*^9}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}],
  FontSize->14], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"R", "=", "1"}], ";", 
   RowBox[{"d", "=", 
    RowBox[{"2", " ", "R"}]}], ";"}],
  FontSize->14], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"sc", "=", 
    RowBox[{"1.75851", "\[Times]", 
     SuperscriptBox["10", "11"], "\[Times]", "0.35", "\[Times]", 
     SuperscriptBox["10", 
      RowBox[{"-", "5"}]]}]}], ";", 
   RowBox[{"time", "=", 
    RowBox[{"60", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}]}], ";"}],
  FontSize->14], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"<<", "\"\<Bx50\>\""}], ";"}],
  FontSize->14], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"Bx", "=", "%"}], ";"}],
  FontSize->14], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"<<", "\"\<By50\>\""}], ";"}],
  FontSize->14], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"By", "=", "%"}], ";"}],
  FontSize->14], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"<<", "\"\<Bz50\>\""}], ";"}],
  FontSize->14], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"Bz", "=", "%"}], ";"}],
  FontSize->14], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"equ", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "''"}], "[", "t", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", "sc"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"y", "'"}], "[", "t", "]"}], " ", 
           RowBox[{"Bz", "[", 
            RowBox[{
             RowBox[{"x", "[", "t", "]"}], ",", 
             RowBox[{"y", "[", "t", "]"}], ",", 
             RowBox[{"z", "[", "t", "]"}]}], "]"}]}], "-", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"z", "'"}], "[", "t", "]"}], " ", 
           RowBox[{"By", "[", 
            RowBox[{
             RowBox[{"x", "[", "t", "]"}], ",", 
             RowBox[{"y", "[", "t", "]"}], ",", 
             RowBox[{"z", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "''"}], "[", "t", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", "sc"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"z", "'"}], "[", "t", "]"}], " ", 
           RowBox[{"Bx", "[", 
            RowBox[{
             RowBox[{"x", "[", "t", "]"}], ",", 
             RowBox[{"y", "[", "t", "]"}], ",", 
             RowBox[{"z", "[", "t", "]"}]}], "]"}]}], "-", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "'"}], "[", "t", "]"}], " ", 
           RowBox[{"Bz", "[", 
            RowBox[{
             RowBox[{"x", "[", "t", "]"}], ",", 
             RowBox[{"y", "[", "t", "]"}], ",", 
             RowBox[{"z", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"z", "''"}], "[", "t", "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"-", "sc"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x", "'"}], "[", "t", "]"}], " ", 
           RowBox[{"By", "[", 
            RowBox[{
             RowBox[{"x", "[", "t", "]"}], ",", 
             RowBox[{"y", "[", "t", "]"}], ",", 
             RowBox[{"z", "[", "t", "]"}]}], "]"}]}], "-", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "'"}], "[", "t", "]"}], " ", 
           RowBox[{"Bx", "[", 
            RowBox[{
             RowBox[{"x", "[", "t", "]"}], ",", 
             RowBox[{"y", "[", "t", "]"}], ",", 
             RowBox[{"z", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "'"}], "[", "0", "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{"y", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "'"}], "[", "0", "]"}], "\[Equal]", 
       RowBox[{"0.3", " ", 
        SuperscriptBox["10", "6"]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"z", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"z", "'"}], "[", "0", "]"}], "\[Equal]", 
       RowBox[{"0.15", " ", 
        SuperscriptBox["10", "6"]}]}]}], "}"}]}], ";"}],
  FontSize->14], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"s", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{"equ", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "time"}], "}"}]}], "]"}]}],
  FontSize->14], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], "/.", 
     RowBox[{"s", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}],
  FontSize->14], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"ParametricPlot3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "[", "t", "]"}], ",", 
        RowBox[{"y", "[", "t", "]"}], ",", 
        RowBox[{"z", "[", "t", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "t0"}], "}"}], ",", 
      RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
      RowBox[{"AxesStyle", "\[Rule]", "Thin"}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
      ",", " ", "\[IndentingNewLine]", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Thin", ",", "Black"}], "}"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", "2"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", " ", "0.3"}], " ", "d"}], ",", 
           RowBox[{"0.3", " ", "d"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "0.3"}], " ", "d"}], ",", 
           RowBox[{"0.3", " ", "d"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "0.75"}], " ", "d"}], ",", 
           RowBox[{"0.75", " ", "d"}]}], "}"}]}], "}"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t0", ",", 
      RowBox[{"0.001", " ", "time"}], ",", "time"}], "}"}]}], "]"}],
  FontSize->14]}], "Input",
 CellChangeTimes->{{3.666962200782309*^9, 3.6669622019378347`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"By0", "[", 
      RowBox[{"y_", ",", "z_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"R", " ", "z", " ", 
         RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["z", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["R", "2"], "-", 
           RowBox[{"2", "R", " ", "y", " ", 
            RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]]], ",", 
       RowBox[{"{", 
        RowBox[{"\[CurlyPhi]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Bz0", "[", 
      RowBox[{"y_", ",", "z_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"R", " ", 
         RowBox[{"(", 
          RowBox[{"R", "-", 
           RowBox[{"y", " ", 
            RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["z", "2"], "+", 
           SuperscriptBox["y", "2"], "+", 
           SuperscriptBox["R", "2"], "-", 
           RowBox[{"2", "R", " ", "y", " ", 
            RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]]], ",", 
       RowBox[{"{", 
        RowBox[{"\[CurlyPhi]", ",", "0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"By", "[", 
      RowBox[{"y_", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"By0", "[", 
       RowBox[{"y", ",", 
        RowBox[{"z", "-", 
         RowBox[{"d", "/", "2"}]}]}], "]"}], "+", 
      RowBox[{"By0", "[", 
       RowBox[{"y", ",", 
        RowBox[{"z", "+", 
         RowBox[{"d", "/", "2"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Bz", "[", 
      RowBox[{"y_", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Bz0", "[", 
       RowBox[{"y", ",", 
        RowBox[{"z", "-", 
         RowBox[{"d", "/", "2"}]}]}], "]"}], "+", 
      RowBox[{"Bz0", "[", 
       RowBox[{"y", ",", 
        RowBox[{"z", "+", 
         RowBox[{"d", "/", "2"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d", "=", 
     RowBox[{"R", "=", "1"}]}], ";", 
    RowBox[{"r1", "=", 
     RowBox[{"step", "=", 
      RowBox[{"0.005", "R"}]}]}], ";", 
    RowBox[{"r2", "=", 
     RowBox[{"2", "R"}]}], ";", 
    RowBox[{"forceline", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", "=", "0"}], ";", 
      RowBox[{"p", "=", 
       RowBox[{"{", 
        RowBox[{"r1", ",", "y0"}], "}"}]}], ";", 
      RowBox[{"single", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"p", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ">=", "r1"}], ")"}], 
         "\[And]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Norm", "[", "p", "]"}], "<", "r2"}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"single", ",", "p"}], "]"}], ";", 
         RowBox[{"p", "=", 
          RowBox[{"p", "+", 
           RowBox[{"step", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Theta]", "=", 
          RowBox[{"Arg", "[", 
           RowBox[{
            RowBox[{"Bz", "[", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"p", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "+", 
            RowBox[{"\[ImaginaryI]", " ", 
             RowBox[{"By", "[", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"p", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"forceline", ",", "single"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "single", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"single", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"single", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"single", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"forceline", ",", "single"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y0", ",", 
       RowBox[{"-", "R"}], ",", "R", ",", 
       RowBox[{"0.1", "R"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
        RowBox[{"Line", "/@", "forceline"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Axes", "\[Rule]", "True"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<z\>\"", ",", "\"\<y\>\""}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Epilog", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", "0.02", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Point", "/@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"d", "/", "2"}], ",", 
             RowBox[{"-", "R"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"d", "/", "2"}], ",", "R"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d"}], "/", "2"}], ",", "R"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d"}], "/", "2"}], ",", 
             RowBox[{"-", "R"}]}], "}"}]}], "}"}]}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.667173190966536*^9, 3.667173191263577*^9}}]
},
WindowSize->{808, 655},
WindowMargins->{{214, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 10455, 309, 1228, "Input"],
Cell[11016, 331, 7014, 213, 458, "Input"],
Cell[18033, 546, 7085, 202, 465, "Input"]
}
]
*)

(* End of internal cache information *)
